!function(){return function e(t,n,r){function i(o,u){if(!n[o]){if(!t[o]){var c="function"==typeof require&&require;if(!u&&c)return c(o,!0);if(a)return a(o,!0);var s=new Error("Cannot find module '"+o+"'");throw s.code="MODULE_NOT_FOUND",s}var f=n[o]={exports:{}};t[o][0].call(f.exports,function(e){return i(t[o][1][e]||e)},f,f.exports,e,t,n,r)}return n[o].exports}for(var a="function"==typeof require&&require,o=0;o<r.length;o++)i(r[o]);return i}}()({1:[function(e,t,n){(function(t){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};Object.defineProperty(n,"__esModule",{value:!0});var i,a,o,u=e(2);beforeEach(function(){a=t.alloc(64),o=t.alloc(64),i={pbkdf2:jasmine.createSpy("pbkdf2").and.callFake(function(e,t,n,r,i,o){o(null,a)}),randombytes:jasmine.createSpy("randombytes").and.returnValue(o)}}),describe("getPbkdf2Sha512 (config?: Partial<Pbkdf2Sha512Config>): (password: Buffer|string) => Promise<Pbkdf2sha512Digest>",function(){it("returns a function",function(){expect(u.default()).toEqual(jasmine.any(Function))}),describe("when called without args",function(){var e;beforeEach(function(t){u.default(i)("passphrase").then(function(t){return e=t}).then(function(){return setTimeout(t)}).catch(function(e){return setTimeout(function(){return t.fail(e)})})}),it("configures the returned pbkdf2 function with the following defaults: random salt string of 64 bytes, base64 encoding, 65536 iterations, digest length of 64 bytes, sha512 hmac",function(){expect(i.pbkdf2).toHaveBeenCalledWith(jasmine.any(t),o,65536,64,"sha512",jasmine.any(Function)),expect(i.randombytes).toHaveBeenCalledWith(64),expect(e.spec.encoding).toBe("base64")})}),describe("when called with a valid config object",function(){var e,n;beforeEach(function(a){e=r({encoding:"ascii",salt:t.alloc(32),iterations:8192,length:32},i),u.default(e)("passphrase").then(function(e){return n=e}).then(function(){return setTimeout(a)}).catch(function(e){return setTimeout(function(){return a.fail(e)})})}),it("configures the returned pbkdf2 function with the properties of the config object",function(){expect(i.pbkdf2).toHaveBeenCalledWith(jasmine.any(t),e.salt,e.iterations,e.length,"sha512",jasmine.any(Function)),expect(i.randombytes).not.toHaveBeenCalled(),expect(n.spec.encoding).toBe(e.encoding)})}),describe("when called with an invalid config object, or a config object with invalid properties",function(){var e,n;beforeEach(function(a){e=r({encoding:"foo",salt:t.alloc(31),iterations:8191,length:31},i),u.default(e)("passphrase").then(function(e){return n=e}).then(function(){return setTimeout(a)}).catch(function(e){return setTimeout(function(){return a.fail(e)})})}),it("configures the returned pbkdf2 function of each invalid property to its default value",function(){expect(i.pbkdf2).toHaveBeenCalledWith(jasmine.any(t),o,65536,64,"sha512",jasmine.any(Function)),expect(i.randombytes).toHaveBeenCalledWith(64),expect(n.spec.encoding).toBe("base64")})}),describe("when called with `relaxed: true`",function(){var e,n;beforeEach(function(t){e=r({iterations:1,relaxed:!0},i),u.default(e)("passphrase").then(function(e){return n=e}).then(function(){return setTimeout(t)}).catch(function(e){return setTimeout(function(){return t.fail(e)})})}),it("accepts any strictly positive iteration count",function(){expect(i.pbkdf2).toHaveBeenCalledWith(jasmine.any(t),o,1,64,"sha512",jasmine.any(Function)),expect(i.randombytes).toHaveBeenCalledWith(64),expect(n.spec.encoding).toBe("base64")})})}),describe("pbkdf2Sha512 (password: Buffer|Uint8Array|string) => Promise<Pbkdf2sha512Digest>",function(){describe("when called with a string, Buffer, or Uint8Array",function(){var e,n;beforeEach(function(a){e=r({encoding:"ascii"},i);var o=t.from("passphrase","ascii"),c=["passphrase",o,new Uint8Array(o.buffer)],s=u.default(e);Promise.all(c.map(function(e){return s(e)})).then(function(e){return n=e}).then(function(){return setTimeout(a)}).catch(function(e){return setTimeout(function(){return a.fail(e)})})}),it("returns the pbkdf2 digest of the given argument together with the corresponding pbkdf2 parameters",function(){i.pbkdf2.calls.allArgs().every(function(e){return expect(e[0].toString()).toBe("passphrase")}),n.every(function(e){return expect(e.value.toString("ascii")).toBe(a.toString())&&expect(e.spec).toEqual({encoding:"ascii",salt:o.toString(),iterations:65536,length:64})})})}),describe('when instantiated with `{ encoding: "none" }`',function(){var e,n;beforeEach(function(a){e=r({encoding:"none"},i);var o=t.from("passphrase","ascii"),c=["passphrase",o,new Uint8Array(o.buffer)],s=u.default(e);Promise.all(c.map(function(e){return s(e)})).then(function(e){return n=e}).then(function(){return setTimeout(a)}).catch(function(e){return setTimeout(function(){return a.fail(e)})})}),it("returns the raw (Buffer) pbkdf2 digest of the given argument together with the corresponding pbkdf2 parameters",function(){i.pbkdf2.calls.allArgs().every(function(e){return expect(e[0].toString()).toBe("passphrase")}),n.every(function(e){return expect(e.value).toEqual(a)&&expect(e.spec).toEqual({encoding:"none",salt:o.toString(),iterations:65536,length:64})})})}),describe("when called with anything else",function(){var e,t;beforeEach(function(n){e=r({encoding:"ascii"},i);var a=u.default(e);Promise.all([null,void 0,42,[],{}].map(function(e){return a(e).catch(function(e){return e})})).then(function(e){return t=e}).then(function(){return setTimeout(n)}).catch(function(e){return setTimeout(function(){return n.fail(e)})})}),it('throws an "invalid arguments" TypeError',function(){t.every(function(e){return expect(e).toEqual(jasmine.any(TypeError))&&expect(e.message).toBe("invalid argument")})})})})}).call(this,e("buffer").Buffer)},{2:2,undefined:void 0}],2:[function(e,t,n){(function(t){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};Object.defineProperty(n,"__esModule",{value:!0});var i=e(3),a={encoding:["base64","utf8","latin1","binary","ascii","hex","none"],salt:{default:64,min:32},iterations:{default:65536,min:8192},length:{default:64,min:32,max:64}};function o(e){try{return e&&i.isArrayBuffer(e.buffer)?t.from(e.buffer):e}catch(t){return e}}function u(e,n){return"none"!==n&&i.isString(e)?t.from(e.valueOf(),n):e}var c=function(){function n(e,t,n,r,i){this.pbkdf2=e,this.encoding=t,this.salt=n,this.iterations=r,this.length=i,this.hmac="sha512"}return n.prototype.hash=function(e){var t=this,n={encoding:this.encoding,salt:this.salt.chars||this.salt.bytes,iterations:this.iterations,length:this.length,hmac:this.hmac};return new Promise(function(r,i){t.pbkdf2(e,t.salt.bytes,t.iterations,t.length,t.hmac,function(e,a){e&&i(e);var o="none"===t.encoding?a:a.toString(t.encoding);r({value:o,spec:n})})})},n.getKdf=function(c){var s=c&&c.pbkdf2||e("pbkdf2").pbkdf2,f=function(e,n){var c=r({},n),s=function(e){var t=i.isString(e)&&e.valueOf();return a.encoding.indexOf(t)>=0?t:a.encoding[0]}(c.encoding),f=function(e,n,r){var c=o(function(e,t){return i.isNumber(t)?e(t.valueOf()):t}(e,u(n,r)));return t.isBuffer(c)&&c.length>=a.salt.min?t.from(c):e(a.salt.default)}(e,c.salt,s),l={encoding:s,salt:{bytes:f},iterations:function(e,t){var n=i.isNumber(e)&&Math.floor(e.valueOf());return e>=(t?1:a.iterations.min)?n:a.iterations.default}(c.iterations,c.relaxed),length:function(e){var t=i.isNumber(e)&&e.valueOf();return e>=a.length.min&&e<=a.length.max?t:a.length.default}(c.length)};return"none"!==s&&(l.salt.chars=f.toString(s)),l}(c&&c.randombytes||e("randombytes"),c),l=new n(s,f.encoding,f.salt,f.iterations,f.length);return function(e){var n=o(u(e,"utf8"));return t.isBuffer(n)?l.hash(n):Promise.reject(new TypeError("invalid password"))}},n}().getKdf;n.default=c}).call(this,e("buffer").Buffer)},{3:3,undefined:void 0}],3:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.isString=function(e){return"string"==typeof(e&&e.valueOf())},n.isNumber=function(e){return"number"==typeof(e&&e.valueOf())},n.isArrayBuffer=function(e){return"[object ArrayBuffer]"===Object.prototype.toString.call(e)}},{}]},{},[1]);